import sys, csv

if len(sys.argv) < 3:
    print(
        "Please provide a CSV file for analysis and specify the target file.\nUsage: python thisScript.py input.csv output.csv\nExiting...")
    sys.exit()

inputFile = str(sys.argv[1])
outputFile = str(sys.argv[2])

words = []
counter = 0
reader = open(inputFile, encoding='utf8')

print("Step 1: Reading Input... ")
for line in reader:
    csv_words = line.split(" ")
    for i in csv_words:
        words.append(i)

print("Step 2: Counting words... ")
words_counted = []
for i in words:
    words_counted.append((words.count(i), i))
    if counter % 1000 == 0:  # speed improvement, because otherwise console output limits speed
        print("Line " + str(int(counter / 1000)) + "k of: " + str(int(len(words) / 1000)) + "k")
    counter += 1

print("Step 3: Writing results... ")
with open(outputFile, 'wb+') as f:
    data = f.read()
    f.seek(0)
    writer = csv.writer(f)
    words_counted = sorted(set(words_counted), reverse=True)
    writer.writerows(words_counted)

print("Finished.")
